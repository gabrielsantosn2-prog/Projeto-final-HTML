<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro</title>
    <link rel="shortcut icon" href="./IMG/icone grande sem fundo.png" type="image/x-icon">

    <style>
    body {
        /*Fundo e Fonte*/
            font-family: Arial, Helvetica, sans-serif;
            background-image:url(./IMG/background\ tipo\ 1.png);
            background-size: 100%;
        }
        /*Estilo da tela de cadastro*/
        #telinhacad{
            background-color: rgba(255, 250, 250);
            position:absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 50px;
            border-radius: 20px;
            }
        
        input{
            padding: 10px;
            outline: none;
            font-size: 10px;
        }

    button{
            background-color: dodgerblue;
            border-radius: none;
            font-size: 20;
            padding: 10px;
            width: 100%;
        }

</style>
</head>

<body>
    <div id="telinhacad">
        <h1>Cadastro</h1>
        
        <form onsubmit="return validarCadastro(event)" action="Login.html"> 
            <input type="text" placeholder="Nome" required id="cadastroNome">
            <input type="text" placeholder="Sobrenome" required id="cadastroSobrenome">
            
            <br><br>
            <input type="email" placeholder="E-mail" required id="cadastroEmail"> <br><br>
            
            <input type="password" placeholder="Senha" required id="senha">
            <input type="password" placeholder="Confirmar senha" required id="confirmarSenha">
            <br>
            <p id="erro-senha" style="color: red; margin-top: 10px; font-size: 12px;"></p> 
            <br>
            
            <input type="date" placeholder="dd//mm//aa" required>
            <input type="tel" placeholder="Número de Telefone" required>
            <br><br>
            <button type="submit">Cadastrar-se</button>
        </form>
    </div>
        
    <script>
        function validarCadastro(event) {
            // Os IDs agora estão no HTML, podemos acessá-los
            const senha = document.getElementById('senha').value;
            const confirmarSenha = document.getElementById('confirmarSenha').value;
            const email = document.getElementById('cadastroEmail').value; 
            const erroSenha = document.getElementById('erro-senha');
            let mensagemErro = "";
            
            // 1. REGRA: Senhas são iguais?
            if (senha !== confirmarSenha) {
                mensagemErro += "As senhas não coincidem. ";
            }

            // 2. REGRA: Complexidade da Senha (Mínimo 8 caracteres, Maiúscula, Minúscula, Número, Especial)
            const regexComplexidade = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

            if (!regexComplexidade.test(senha)) {
                mensagemErro += "A senha deve ter no mínimo 8 caracteres, incluindo letra maiúscula, minúscula, número e caractere especial (@$!%*?&).";
            }

            if (mensagemErro !== "") {
                erroSenha.innerHTML = mensagemErro;
                event.preventDefault(); // Impede o envio
                return false;
            } else {
                // == PARTE NOVA: SALVANDO O CADASTRO NO LOCALSTORAGE ==
                const novoUsuario = {
                    email: email,
                    senha: senha 
                };

                localStorage.setItem(email, JSON.stringify(novoUsuario));
                
                alert('Cadastro realizado com sucesso! Você será redirecionado para a área de login.');
                
                erroSenha.innerHTML = "";
                return true; // Permite o envio para a action="Login.html"
            }
        }
    </script>
</body>
</html>